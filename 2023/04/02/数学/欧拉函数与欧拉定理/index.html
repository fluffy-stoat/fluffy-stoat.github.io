<!DOCTYPE html>
<html lang="zh-CN">
   

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="keywords" content="">
  <meta name="description" content="Ov-">
  <meta name="generator" content="Hexo 7.3.0">
  <title>欧拉函数与欧拉定理 - fluffy-stoat&#39;s Notes</title>
  <link rel="shortcut icon" href="/images/favicon.ico" />
  
<link rel="stylesheet" href="/css/ssimple.css?20250905.css">

  
<link rel="stylesheet" href="/iconfont/iconfont.css?20250905.css">

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" 
    crossorigin="anonymous"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function(){
      window.renderKatex();
    });
  </script>


</head>

  <body>
    <header>
  <div class="header" style="width: 100%;">
    <div class="header-inner" style="position: fixed; z-index: 20; top: 0; left: 0;">
      <div class="header-content" style="max-width: 1200px; margin: auto;">
        <div class="blog-title">
          <span class="iconfont icon-menu1" id="menu-button"></span>
          <a href="/" class="logo header-title">
            fluffy-stoat&#39;s Notes
          </a>
          
            <div class="mobile-search">
              <input type="text" />
              <span class="iconfont icon-search mobile-search-icon"></span>
              <span class="iconfont icon-baseline-close-px search-close-icon"></span>
            </div>
          
        </div>
        <div class="navbar" id="menu-list">
          <ul class="menu">
            
              <li class="menu-item">
                <a href="/archives/" class="menu-item-link">
                    
                    <span class="menu-item-icon iconfont icon-work"></span>
                    
                    Archives
                  
                </a>
              </li>
            
              <li class="menu-item">
                <a href="/directory/" class="menu-item-link">
                    
                    <span class="menu-item-icon iconfont icon-folder-close"></span>
                    
                    Directory
                  
                </a>
              </li>
            
              <li class="menu-item">
                <a href="/about/" class="menu-item-link">
                    
                    <span class="menu-item-icon iconfont icon-user"></span>
                    
                    About
                  
                </a>
              </li>
            
          </ul>
        </div>
        
          <div class="search">
            <input type="text" />
            <span class="iconfont icon-search search-icon"></span>
            <span class="iconfont icon-baseline-close-px search-close-icon"></span>
          </div>
        
      </div>
    </div>
    
      <div class="search-shadow"> </div>
      <div class="search-box">
        <div class="search-container">
  <div class="search-container-inner">
    <div class="search-data-status">
      <span>Fetching search data...</span>
    </div>
    <div class="search-count"></div>
    <div class="search-result"></div>
  </div>
</div>
      </div>
    
  </div>
</header>

    <main class="main">
      <article class="post">
  <div class="post-title">
    <h1 class="page-title">欧拉函数与欧拉定理</h1>
  </div>
  <div class="post-meta">
  <div class="post-info">
    <span class="post-info-item post-time" title="2023年4月2日星期日上午11点08分 (CST+08:00)">
      <span class="info-icon iconfont icon-time"></span>更新于 2023年4月2日
    </span>
    
      <span class="icon infosep"></span><span class="post-info-item post-wordcount">
        <span class="info-icon iconfont icon-text"></span>约 1,937 字
      </span>
    
    
  </div>
  <div class="post-directory">
    
    <span class="iconfont icon-folder-close"></span>
    <a class="directory" href="/directory">Home</a>
    
        
        <a class="directory" href="/directory/">
          
        </a>
        <span class="icon smallarrow"></span>
    
        
        <a class="directory" href="/directory/%E6%95%B0%E5%AD%A6/">
          数学
        </a>
        <span class="icon smallarrow"></span>
    
    当前文章
  </div>
  
  <hr />
</div>
   

  
    <div class="toc">
  
    <h2 class="toc-title">
      <span
       class="iconfont icon-explain" 
       style="font-size: 1em;padding-right: 5px;"></span
      >文章目录</h2>
    <div class="toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#积性函数"><span class="toc-number">1.</span> <span class="toc-text">积性函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#欧拉函数"><span class="toc-number">2.</span> <span class="toc-text">欧拉函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#欧拉函数是积性函数"><span class="toc-number">2.1.</span> <span class="toc-text">欧拉函数是积性函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#线性筛求欧拉函数的值-："><span class="toc-number">2.2.</span> <span class="toc-text">线性筛求欧拉函数的值 ：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#欧拉定理"><span class="toc-number">3.</span> <span class="toc-text">欧拉定理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#扩展欧拉定理"><span class="toc-number">4.</span> <span class="toc-text">扩展欧拉定理</span></a></li></ol>
    </div>
    <hr />
  </div>


  <div class="post-content">
    <h2 id="积性函数"><a href="#积性函数" class="headerlink" title="积性函数"></a>积性函数</h2><p>定义：若 $a,b$ 互质时，有 $f(ab)&#x3D;f(a)*f(b)$ ,那么称函数 $f$ 为积性函数。</p>
<p>$ps$：$cbj$大佬说所有积性函数都可以用线性筛求值 $qwq$</p>
<h2 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h2><p>$\varphi(n)$ 表示比 $n$ 小的与 $n$ 互质的正整数的个数</p>
<p>对 $n$ 做质因数分解,得到 $n&#x3D;p_1^{c_1}p_2^{c_2}\cdots p_m^{c_m}$ 则：</p>
<p>$$<br>\varphi(n)&#x3D;n*(1-{1\over p_1})<em>(1-{1\over p_2})</em>\cdots *(1-{1\over p_m})<br>$$</p>
<p>证明：</p>
<p>若 $n$ 含有两个不同的质因子 $p,q$ ,</p>
<p>那么在 $1$ ~ $n$ 中 $p$ 的倍数有 $\cfrac {n}{p}$ 个，$q$ 的倍数有 $\cfrac {n}{q}$ 个，</p>
<p>如果我们把这 $\cfrac {n}{p}+\cfrac {n}{q}$ 个数减掉，</p>
<p>那么 $p,q$ 的共同因子就会被排除两遍，需要加回来一次。</p>
<p>因此 $1$ ~ $n$ 中不与 $n$ 含有共同因子 $p,q$ 的数的个数为：</p>
<p>$$<br>n-\cfrac {n}{p}-\cfrac {n}{q}+\cfrac {n}{pq}&#x3D;n(1-{1\over p})(1-{1\over q})<br>$$</p>
<h3 id="欧拉函数是积性函数"><a href="#欧拉函数是积性函数" class="headerlink" title="欧拉函数是积性函数"></a>欧拉函数是积性函数</h3><p>证明：根据我们得到的式子可得对于两个互质的数 $a,b$ 有</p>
<p>$$<br>\varphi(a)\varphi(b)&#x3D;a*\prod_{质数p\mid a}(1-p)<em>b</em>\prod_{质数p\mid b}(1-p)&#x3D;(a<em>b)</em>\prod_{质数p\mid (a<em>b)}(1-p)&#x3D;\varphi(a</em>b)<br>$$</p>
<h3 id="线性筛求欧拉函数的值-："><a href="#线性筛求欧拉函数的值-：" class="headerlink" title="线性筛求欧拉函数的值 ："></a>线性筛求欧拉函数的值 ：</h3><p>需要利用的三条性质：</p>
<ul>
<li>1 若 $x$ 为质数，那么 $\varphi(x)&#x3D;x-1$</li>
<li>2 设 $p$ 为质数，若对于一个数 $x$ 有 $p\mid x$ 且 $p^2\mid x$ ,则 $\varphi(x)&#x3D;\varphi(x&#x2F;p)*p$</li>
<li>3 设 $p$ 为质数，若对于一个数 $x$ 有 $p\mid x$ 但 $p^2\not\mid x$ ,则 $\varphi(x)&#x3D;\varphi(x&#x2F;p)*\varphi(p)$</li>
</ul>
<p>证明：</p>
<p>第一条性质是显然的</p>
<p>第二条性质可以从公式中得到，因为 $x$ 和 $x&#x2F;p$ 含有的质因子种类完全一样，所以 $\varphi(x)$ 和 $\varphi(x&#x2F;p)$ 的商由公式可得是 $p$ ，所以 $\varphi(x)&#x3D;\varphi(x&#x2F;p)*p$</p>
<p>第三条性质可以直接由 $\varphi(n)$ 为积性函数得到</p>
<p>那么我们就可以利用这三条性质，在线性筛的基础上在 $\Theta(n)$ 的时间复杂度里求出 $1$~$n$ 的欧拉函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#define ll long long</span><br><span class="line"></span><br><span class="line">ll n,phi[N],prime[N],tot,v[N];</span><br><span class="line"></span><br><span class="line">for(int i=2;i&lt;=n;i++)&#123;</span><br><span class="line"></span><br><span class="line">    if(v[i]==0)&#123;</span><br><span class="line"></span><br><span class="line">        prime[tot++]=i;</span><br><span class="line"></span><br><span class="line">        phi[i]=i-1;</span><br><span class="line"></span><br><span class="line">        v[i]=i;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for(int j=0;j&lt;tot;j++)&#123;</span><br><span class="line"></span><br><span class="line">        if(v[i]&lt;prime[j]||prime[j]*i&gt;n)break;</span><br><span class="line"></span><br><span class="line">        v[i*prime[j]]=prime[j];</span><br><span class="line"></span><br><span class="line">        if(i%prime[j])phi[i*prime[j]]=phi[i]*phi[prime[j]];</span><br><span class="line"></span><br><span class="line">        else phi[i*prime[j]]=phi[i]*prime[j];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="欧拉定理"><a href="#欧拉定理" class="headerlink" title="欧拉定理"></a>欧拉定理</h2><p>$$<br>a^{\varphi(n)}\equiv1\pmod n\quad\quad (a\bot n)<br>$$</p>
<p>证明：</p>
<p>$$<br>a^{\varphi(n)}x_1x_2x_3\cdots x_{\varphi(n)}\pmod n \tag{1}<br>$$</p>
<p>$$<br>\equiv (ax_1)(ax_2)\cdots(ax_{\varphi(n)})\pmod n \tag{2}<br>$$</p>
<p>因为 $a\bot n$ , 所以 $x_i\bot n$ ,所以 $ax_i\bot n$ ，所以 $ax_i \mod m$ 属于 $n$ 的简化剩余系，</p>
<p>因为 {$x_1,x_2,x_3\cdots x_{\varphi(n)}$} 正好构成了 $n$ 的简化剩余系，又有对于任意不相等的 $x_i,x_j$ 存在若 $a\bot n$ 那么 $ax_i\not\equiv ax_j\pmod n$</p>
<p>所以,对构成 $n$ 的简化剩余系的元素分别乘上 $a$ ,得到的数恰好又构成 $n$ 的简化剩余系,</p>
<p>即上面的式子等价于：</p>
<p>$$<br>x_1x_2x_3\cdots x_{\varphi(n)}\pmod n \tag{3}<br>$$</p>
<p>对(1)、(3)式两边同除 $x_1x_2x_3\cdots x_{\varphi(n)}$ 可得：</p>
<p>$$<br>a^{\varphi(n)}\equiv1\pmod n<br>$$</p>
<p>证毕。</p>
<p><em><strong>可以发现其实费马小定理就是欧拉定理的特例，因为当p为质数时，$\varphi(p)&#x3D;p-1$</strong></em></p>
<p>扩展：</p>
<p>$$<br>a^{b}\equiv a^{b\mod\varphi(n)}\pmod n\quad\quad (a\bot n)<br>$$</p>
<p>证明：设 $b&#x3D;q*\varphi(n)+r$ ,其中 $0\leq r&lt;\varphi(n)$ ,即 $r&#x3D;b \mod\varphi(n)$ ,于是：</p>
<p>$$<br>a^b\equiv a^{q*\varphi(n)+r}\equiv1^q*a^r\equiv a^r\equiv a^{b \mod\varphi(n)}\pmod n<br>$$</p>
<p>证毕</p>
<p>这个欧拉定理的小扩展可以帮我们有效降幂，但是他显然还不够一般，为了可以更方便的降幂，我们有：</p>
<h2 id="扩展欧拉定理"><a href="#扩展欧拉定理" class="headerlink" title="扩展欧拉定理"></a>扩展欧拉定理</h2><p>$$<br>a^b \equiv a^{(b\mod\varphi(c))+\varphi(c)}\pmod c<br>$$</p>
<p>证明：</p>
<p>我们可以考虑对 $a$ 做质因数分解，</p>
<p>对于 $a$ 的质因数中与 $c$ 互质的 $p$ 因为欧拉定理显然符合上式，</p>
<p>对于 $p\mid c$ ，我们可以先把 $c$ 拆成 $s<em>p^r$ ，其中 $s$ 与 $p$ 互质，因为$p^{\varphi(s)}\equiv 1\pmod s$，因为欧拉函数为积性函数，所以 $\varphi(s)</em>\varphi(p^r)&#x3D;\varphi(c)$ ，那么显然有</p>
<p>$$<br>p^{\varphi(c)}\equiv1\pmod s<br>$$</p>
<p>从而</p>
<p>$$<br>p^{b}\equiv p^{b\mod\varphi(c)}\pmod s<br>$$</p>
<p>两边同乘 $p^r$，因为 $c&#x3D;s*p^r$，所以</p>
<p>$$<br>p^{b+r}\equiv p^{(b\mod\varphi(c))+r}\pmod c<br>$$</p>
<p>因为 $c&#x3D;s*p^r$，所以 $\varphi(c)\ge r$，所以可以对两边同乘 $p^{\varphi(c)-r}$</p>
<p>$$<br>p^{b}\equiv p^{(b\mod\varphi(c))+\varphi(c)}\pmod c<br>$$</p>
<p>证毕</p>

  </div>
  
  <hr>
  <h3><span class="iconfont icon-history" style="padding-right: 5px;font-size: 1em;"></span>修订记录</h3>
  <div class="post-history-list"><ol reversed>
    
      <li class="post-history-item">
        2023年4月2日 创建文章 
      </li>
     
  </ol></div>

  <div class="post-footer">
  <hr>
  
    <div class="next-post">
      <span class="iconfont icon-arrow-left-circle"></span> 
      <a href="/2023/03/29/DP/ddp/">
        浅谈ddp
      </a>
    </div>
  
  
    <div class="prev-post">
      <a href="/2023/04/02/数学/扩展欧几里得算法/">
        扩展欧几里得算法
      </a> 
      <span class="iconfont icon-arrow-right-circle"></span>
    </div>
  
</div>
</article>


  <div id="vcomments"></div>


    </main>
  </body>
  <div class="side-button">
  
    <div id="comment-button" class="button" title="Valine Comment" >
      <span class="iconfont icon-comment"></span>
    </div>
  
    <div id="darkmode-button" class="button" title="Switch between day and night" >
      <span class="iconfont icon-moonbyueliang"></span>
    </div>
  
    <div id="top" class="button" title="Back to top" >
      <span class="iconfont icon-arrowup"></span>
    </div>
  
</div>

  <footer id="footer" style="margin: 3em 0 2em 0; text-align: center; line-height: 1.4em">

  
  <div class="visitor">
    <span id="/about/" class="leancloud_visitors" data-flag-title="About">
      <span class="iconfont icon-eye"></span>
      <span class="post-meta-item-text">Page view </span>
      <i class="leancloud-visitors-count"></i>
    </span>
  </div>



  
    <span class="post-wordcount iconfont icon-text"></span>
    全站约 35,700 字
  

  <div class="license" style="padding: 0 10px;">
    <span>
    本站所有文章遵循许可协议 
    <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">
      Creative Commons Attribution-ShareAlike 4.0 International License
    </a>
    </span>
  </div>

  <div class="credit">
    <span>Themed
    <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.10.0</a>
    | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span>
  </div>

  

  <div class="copyright">
    <span>Copyright &copy; 2023-2023 - fluffy-stoat</span>
  </div>

</footer>

  
  <script type="text/javascript">
    var valine_path = '/2023/04/02/数学/欧拉函数与欧拉定理/'
  </script>

  
<script src="/js/ssimple.js?20250905.js"></script>
<script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script>



  <script type="text/javascript">
    loadComments();
    function loadComments() {
      if (typeof Valine === 'undefined') {
        var getScript = (options) => {
          var script = document.createElement('script');
          script.defer = true;
          script.crossOrigin = 'anonymous';
          Object.keys(options).forEach((key) => {
            script[key] = options[key];
          });
          document.body.appendChild(script);
        };
        getScript({
          src: 'https://cdn.jsdelivr.net/npm/valine',
          onload: function () {
            newValine();
          }
        });
      } else {
        newValine();
      }
    }
    function newValine() {
      if (valine_path[valine_path.length - 1] != '\/') valine_path = valine_path + '\/';
      new Valine({
        el: '#vcomments',
        appId: '',
        appKey: '',
        placeholder: '',
        serverURLs: '',
        visitor: true,
        recordIP: true,
        requiredFields: ['nick', 'mail'],
        avatar: 'retro',
        path: valine_path
      });
    }
  </script>

</html>
